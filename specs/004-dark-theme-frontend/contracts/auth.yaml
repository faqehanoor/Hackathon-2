# Authentication API Contract

## Endpoints

### POST /api/auth/register

Register a new user account.

**Request Body:**

```json
{
  "email": "user@example.com",
  "name": "John Doe",
  "password": "securepassword123"
}
```

**Schema:**

| Field | Type | Required | Validation |
|-------|------|----------|------------|
| email | string | Yes | Valid email format, max 255 chars |
| name | string | Yes | 1-100 chars, non-empty |
| password | string | Yes | Min 8 chars |

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 201 | User created | `{ "user": {...}, "token": "jwt_token" }` |
| 400 | Validation error | `{ "detail": "..." }` |
| 409 | Email exists | `{ "detail": "Email already registered" }` |

**Example Success Response:**

```json
{
  "success": true,
  "data": {
    "user": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "email": "user@example.com",
      "name": "John Doe",
      "created_at": "2025-12-31T10:00:00Z"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  },
  "message": "User registered successfully"
}
```

---

### POST /api/auth/login

Authenticate user and receive JWT token.

**Request Body:**

```json
{
  "email": "user@example.com",
  "password": "securepassword123"
}
```

**Schema:**

| Field | Type | Required | Validation |
|-------|------|----------|------------|
| email | string | Yes | Valid email format |
| password | string | Yes | Min 8 chars |

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 200 | Login successful | `{ "user": {...}, "token": "jwt_token" }` |
| 401 | Invalid credentials | `{ "detail": "Invalid email or password" }` |
| 400 | Validation error | `{ "detail": "..." }` |

**Example Success Response:**

```json
{
  "success": true,
  "data": {
    "user": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "email": "user@example.com",
      "name": "John Doe",
      "created_at": "2025-12-31T10:00:00Z"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  },
  "message": "Login successful"
}
```

---

### POST /api/auth/logout

Logout user (client-side token removal).

**Note:** This endpoint may be a no-op as JWT tokens are stateless. Client should remove token from storage.

**Responses:**

| Status | Description |
|--------|-------------|
| 200 | Logout successful |

---

### GET /api/auth/me

Get current authenticated user profile.

**Headers:**

| Header | Value |
|--------|-------|
| Authorization | Bearer {token} |

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 200 | User profile | `{ "user": {...} }` |
| 401 | Unauthorized | `{ "detail": "Not authenticated" }` |

---

## Token Format

JWT Token structure (for frontend reference):

```json
{
  "header": {
    "alg": "HS256",
    "typ": "JWT"
  },
  "payload": {
    "sub": "user_id",
    "email": "user@example.com",
    "exp": 1735689600,
    "iat": 1735686000
  }
}
```

**Token expiry**: 24 hours (configurable)

---

## Error Response Format

```json
{
  "success": false,
  "detail": "Human-readable error message",
  "status_code": 400
}
```

**Common error codes:**

| Code | Meaning |
|------|---------|
| 400 | Bad Request - Invalid input |
| 401 | Unauthorized - Invalid/missing token |
| 403 | Forbidden - Not authorized |
| 404 | Not Found - Resource doesn't exist |
| 500 | Internal Server Error |
