# Tasks API Contract

## Endpoints

All task endpoints REQUIRE JWT authentication via `Authorization: Bearer {token}` header.

---

### GET /api/tasks

Retrieve list of tasks for authenticated user.

**Query Parameters:**

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| status | string | No | "all" | Filter by status: all, active, completed |
| search | string | No | "" | Search in title and description |
| page | number | No | 1 | Page number for pagination |
| limit | number | No | 50 | Items per page |

**Example Request:**

```
GET /api/tasks?status=active&page=1&limit=20
Authorization: Bearer {token}
```

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 200 | List of tasks | `{ "data": [...], "total": 50, "page": 1, "limit": 20 }` |
| 401 | Unauthorized | `{ "detail": "Not authenticated" }` |

**Example Success Response:**

```json
{
  "success": true,
  "data": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "user_id": "550e8400-e29b-41d4-a716-446655440000",
      "title": "Buy groceries",
      "description": "Milk, eggs, bread",
      "completed": false,
      "created_at": "2025-12-31T10:00:00Z",
      "updated_at": "2025-12-31T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "limit": 20
}
```

---

### POST /api/tasks

Create a new task.

**Request Body:**

```json
{
  "title": "Buy groceries",
  "description": "Milk, eggs, bread"
}
```

**Schema:**

| Field | Type | Required | Validation |
|-------|------|----------|------------|
| title | string | Yes | 1-255 chars |
| description | string | No | Max 10,000 chars |

**Example Request:**

```
POST /api/tasks
Authorization: Bearer {token}
Content-Type: application/json

{
  "title": "Buy groceries",
  "description": "Milk, eggs, bread"
}
```

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 201 | Task created | `{ "data": {...task}, "message": "Task created" }` |
| 400 | Validation error | `{ "detail": "..." }` |
| 401 | Unauthorized | `{ "detail": "Not authenticated" }` |

**Example Success Response:**

```json
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "title": "Buy groceries",
    "description": "Milk, eggs, bread",
    "completed": false,
    "created_at": "2025-12-31T10:00:00Z",
    "updated_at": "2025-12-31T10:00:00Z"
  },
  "message": "Task created successfully"
}
```

---

### GET /api/tasks/{id}

Retrieve a specific task.

**Example Request:**

```
GET /api/tasks/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer {token}
```

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 200 | Task details | `{ "data": {...task} }` |
| 404 | Task not found | `{ "detail": "Task not found" }` |
| 401 | Unauthorized | `{ "detail": "Not authenticated" }` |

---

### PUT /api/tasks/{id}

Replace entire task (all fields required).

**Request Body:**

```json
{
  "title": "Updated title",
  "description": "Updated description",
  "completed": true
}
```

**Schema:**

| Field | Type | Required | Validation |
|-------|------|----------|------------|
| title | string | Yes | 1-255 chars |
| description | string | Yes (nullable) | Max 10,000 chars |
| completed | boolean | Yes | - |

**Example Request:**

```
PUT /api/tasks/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer {token}
Content-Type: application/json

{
  "title": "Buy groceries and supplies",
  "description": "Milk, eggs, bread, butter",
  "completed": false
}
```

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 200 | Task updated | `{ "data": {...updated_task} }` |
| 400 | Validation error | `{ "detail": "..." }` |
| 404 | Task not found | `{ "detail": "Task not found" }` |
| 401 | Unauthorized | `{ "detail": "Not authenticated" }` |

---

### PATCH /api/tasks/{id}

Partial update task (only include fields to change).

**Request Body (example - include only what changes):**

```json
{
  "completed": true
}
```

Or:

```json
{
  "title": "New title"
}
```

Or:

```json
{
  "title": "Updated title",
  "description": "Updated description"
}
```

**Schema (all optional):**

| Field | Type | Validation |
|-------|------|------------|
| title | string | 1-255 chars |
| description | string | Max 10,000 chars |
| completed | boolean | - |

**Example Request:**

```
PATCH /api/tasks/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer {token}
Content-Type: application/json

{
  "completed": true
}
```

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 200 | Task updated | `{ "data": {...updated_task} }` |
| 400 | Validation error | `{ "detail": "..." }` |
| 404 | Task not found | `{ "detail": "Task not found" }` |
| 401 | Unauthorized | `{ "detail": "Not authenticated" }` |

---

### DELETE /api/tasks/{id}

Delete a task.

**Example Request:**

```
DELETE /api/tasks/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer {token}
```

**Responses:**

| Status | Description | Body |
|--------|-------------|------|
| 204 | Task deleted (no body) | - |
| 404 | Task not found | `{ "detail": "Task not found" }` |
| 401 | Unauthorized | `{ "detail": "Not authenticated" }` |

---

## Task Schema Definition

```yaml
components:
  schemas:
    Task:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique task identifier
        user_id:
          type: string
          format: uuid
          description: Owner's user ID
        title:
          type: string
          minLength: 1
          maxLength: 255
          description: Task title
        description:
          type: string
          nullable: true
          maxLength: 10000
          description: Optional task description
        completed:
          type: boolean
          default: false
          description: Completion status
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
      required:
        - id
        - user_id
        - title
        - completed
        - created_at
        - updated_at
```

---

## Error Response Format

```json
{
  "success": false,
  "detail": "Human-readable error message",
  "status_code": 400
}
```

**Common error scenarios:**

| Status | Message | Scenario |
|--------|---------|----------|
| 400 | "Title is required" | Empty title |
| 400 | "Title must be 1-255 characters" | Title too long |
| 401 | "Not authenticated" | Missing/invalid token |
| 401 | "Token expired" | Expired JWT |
| 403 | "Access denied" | Task belongs to another user |
| 404 | "Task not found" | Task ID doesn't exist |
