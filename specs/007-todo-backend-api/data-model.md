# Data Model: Todo Backend API

**Feature**: 007-todo-backend-api
**Created**: 2026-01-19

## Overview

This document defines the data models for the Todo Backend API, including entity definitions, relationships, and validation rules.

## Entities

### Task Entity

**Description**: Represents a user's todo item with properties for tracking tasks.

**Fields**:
- `id`: Integer (Primary Key, Auto-increment)
  - Unique identifier for the task
  - Auto-generated by the database
- `user_id`: String (Required)
  - Identifier of the user who owns this task
  - Used for enforcing task ownership
- `title`: String (Required, Max length: 255)
  - Brief description of the task
  - Required field for all tasks
- `description`: String (Optional, Max length: 1000)
  - Detailed description of the task
  - Optional field that may be null
- `completed`: Boolean (Required, Default: False)
  - Status indicating if the task is completed
  - Defaults to False when creating new tasks

**Validation Rules**:
- `title` must be between 1 and 255 characters
- `description` must be between 0 and 1000 characters if provided
- `completed` must be a boolean value
- `user_id` must be a valid identifier string

**State Transitions**:
- `completed` can transition from False to True (marking complete)
- `completed` can transition from True to False (reopening task)

### User Reference

**Description**: Represents a registered user with unique user_id that owns tasks and accesses them via JWT authentication.

**Fields** (Referenced via user_id in Task):
- `user_id`: String (Required)
  - Unique identifier for the user
  - Extracted from JWT token payload
  - Used to enforce task ownership

## Relationships

### Task to User Relationship
- One User (identified by user_id) can own many Tasks
- Each Task belongs to exactly one User
- Foreign Key: Task.user_id references User.user_id
- All operations on Tasks are filtered by the authenticated user's user_id

## Database Schema

```sql
CREATE TABLE tasks (
    id SERIAL PRIMARY KEY,
    user_id VARCHAR(255) NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    completed BOOLEAN DEFAULT FALSE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Index for efficient user-based queries
CREATE INDEX idx_tasks_user_id ON tasks(user_id);

-- Index for efficient completion status queries
CREATE INDEX idx_tasks_completed ON tasks(completed);
```

## API Data Transfer Objects (DTOs)

### Request DTOs

#### CreateTaskRequest
- `title`: String (Required)
- `description`: String (Optional)
- `completed`: Boolean (Optional, Default: False)

#### UpdateTaskRequest
- `title`: String (Optional)
- `description`: String (Optional)
- `completed`: Boolean (Optional)

### Response DTOs

#### TaskResponse
- `id`: Integer
- `user_id`: String
- `title`: String
- `description`: String (May be null)
- `completed`: Boolean
- `created_at`: DateTime (ISO 8601 format)
- `updated_at`: DateTime (ISO 8601 format)

## Constraints

1. **Ownership Constraint**: All task operations must verify that the authenticated user matches the task's user_id
2. **Data Integrity**: Required fields must not be null when creating tasks
3. **Access Control**: Users can only access tasks that belong to their user_id
4. **Validation**: All inputs must be validated before database operations